apiVersion: v1
kind: ConfigMap
metadata:
  name: openclaw-config
  namespace: openclaw
data:
  NODE_ENV: "production"
  OPENCLAW_PORT: "18789"
  OPENCLAW_BIND: "0.0.0.0"
  LOG_LEVEL: "info"

  # Configuracao OpenClaw (sera montada como arquivo)
  openclaw.json: |
    {
      "models": {
        "providers": {
          "minimax": {
            "baseUrl": "https://api.minimax.io/anthropic",
            "apiKey": "${MINIMAX_API_KEY}",
            "api": "anthropic-messages",
            "models": [
              {
                "id": "MiniMax-M2.1",
                "name": "MiniMax M2.1",
                "reasoning": false,
                "input": ["text"],
                "contextWindow": 200000,
                "maxTokens": 8192
              }
            ]
          }
        }
      },
      "agents": {
        "defaults": {
          "model": {
            "primary": "minimax/MiniMax-M2.1"
          },
          "compaction": {
            "mode": "safeguard"
          },
          "maxConcurrent": 4
        },
        "list": [
          {
            "id": "main",
            "default": true,
            "name": "Owner Assistant",
            "workspace": "/data/workspace"
          },
          {
            "id": "leads",
            "name": "Lead Sandbox",
            "workspace": "/data/leads",
            "tools": {
              "deny": [
                "exec", "process", "gateway", "cron",
                "sessions_spawn", "sessions_send", "browser",
                "canvas", "nodes", "message", "agents_list",
                "memory_search", "memory_get"
              ],
              "elevated": {
                "enabled": false
              }
            }
          }
        ]
      },
      "bindings": [
        {
          "agentId": "main",
          "match": {
            "channel": "whatsapp",
            "peer": { "kind": "dm", "id": "+5521923670743" }
          }
        },
        {
          "agentId": "leads",
          "match": {
            "channel": "whatsapp"
          }
        }
      ],
      "channels": {
        "whatsapp": {
          "dmPolicy": "open",
          "allowFrom": ["*"],
          "groupPolicy": "allowlist",
          "mediaMaxMb": 50,
          "debounceMs": 0
        }
      },
      "gateway": {
        "mode": "local",
        "auth": {
          "token": "${GATEWAY_TOKEN}"
        }
      },
      "plugins": {
        "entries": {
          "whatsapp": {
            "enabled": true
          }
        }
      }
    }
